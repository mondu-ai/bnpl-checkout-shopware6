"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["mond1-s-w6"],{7125:(e,t,n)=>{var i,o,r,s=n(6285),d=n(8254);class u extends s.Z{init(){console.log("init started"),this._isWidgetLoaded=this._initWidget(this.options.src),this._registerEvents(),this._registerProperties()}_registerEvents(){console.log("register events",this,this.el.form),this.el.form.addEventListener("submit",this._submitForm.bind(this))}_registerProperties(){this._checkoutConfirmPage=this.el.getAttribute("data-checkout-confirm-page"),this._monduTokenUrl=this.el.getAttribute("data-mondu-token-url")}async _initWidget(e){return new Promise(((t,n)=>{const i=document.createElement("script");i.src=e,document.head.appendChild(i),i.onload=function(){t(!0)},i.onerror=function(){t(!1)}}))}async _submitForm(e){if(this._isWidgetComplete())return!0;if(e.preventDefault(),await this._isWidgetLoaded){this._appendWidgetContainer();const{token:e}=await this._getMonduToken();this._appendTokenToInput(e);const t=this._removeWidgetContainer.bind(this);let n=this;window.monduCheckout.render({token:e,onClose(){t(),n._isWidgetComplete()?n.el.form.submit():window.location.href=n._checkoutConfirmPage},onSuccess(){n._setMonduComplete("1")}})}}async _getMonduToken(){return new Promise((e=>{new d.Z(window.accessKey,window.contextToken).get(this._monduTokenUrl+`?payment_method=${this.options.payment_method}`,(t=>{try{e(JSON.parse(t))}catch(t){e(null)}}))}))}_appendWidgetContainer(){document.getElementById("mondu-checkout-widget").style.display="initial"}_removeWidgetContainer(){const e=document.getElementById("mondu-checkout-widget");e&&(e.style.display="none")}_setMonduComplete(e){this.el.form.dataset.monduComplete=parseInt(e,10)}_isWidgetComplete(){return 1===parseInt(this.el.form.dataset.monduComplete,10)}_appendTokenToInput(e){document.getElementById("mondu-order-id-input").value=e}}i=u,r={src:"",csrfToken:"",payment_method:"invoice"},(o=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(o="options"))in i?Object.defineProperty(i,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[o]=r;const a=window.PluginManager;void 0===a.getPluginList().MonduPlugin&&a.register("MonduPlugin",u,'[data-mondu-checkout="true"]')}},e=>{e.O(0,["vendor-node","vendor-shared"],(()=>{return t=7125,e(e.s=t);var t}));e.O()}]);